# Normalization(정규화)

## database 설계

- 대량의 데이터를 데이터베이스 안에 어떻게 조직하여 구성하느냐는 중요한 문제
- 현실 세계를 정확하고 자연스럽게 반영할 수 있도록 데이터베이스의 논리적 구조를 결정
- 전체 데이터베이스에 대한 통합된 하나의 스키마(schema)를 정의

## 이상(anomaly) 현상

- SELECT문에서는 이상현상이 일어나지 않는다.
- INSERT, UPDATE, DELETE문으로 데이터를 변경할 때는 3가지 이상 현상이 발생

### 1. 삽입 이상

    릴레이션에 새 데이터를 삽입하려면 불필요한 데이터도 함께 삽입해야하는 문제.

### 2. 갱신 이상

    릴레이션의 중복된 투플들 중 일부만 수정하여 데이터가 불일치하게 되는 모순이 발생하는 문제

### 3. 삭제 이상

    릴레이션에서 투플을 삭제하면 꼭 필요한 데이터까지 손실되는 연쇄 삭제 현상이 발생하는 문제

## 이상현상 발생 원인

속성 사이의 많은 연관 관계를 무리하게 하나의 릴레이션으로 표현할 때 발생

---

## 함수 종속

- X가 Y를 함수적으로 결정한다”
- X → Y로 표현(X는 결정자, Y는 종속자)

### 1. 완전 함수 종속

- 릴레이션에서 속성 집합 Y가 속성 집합 X에 함수적으로 종속되어 있지만, 속성 집합 X의 전체가 아닌 일부분에는 종속되지 않음을 의미

### 2. 부분 함수 종속

- 릴레이션에서 속성 집합 Y가 속성 집합 X의 전체가 아닌 일부분에도 함수적으로 종속됨을 의미

---

## 정규화(normalization)

함수 종속성을 이용해 릴레이션을 연관성이 있는 속성들로만 구성되도록 분해해서, 이상 현상이 발생하지 않는 올바른 릴레이션으로 만들어 가는 과정

### 주의사항

- 정규화를 통해 릴레이션은 무손실 분해(nonloss decomposition)되어야 함

무손실 분해(nonloss decomposition): 분해된 릴레이션들을 자연 조인하면 분해 전의 릴레이션으로 복원 가능해야 함(정보 손실X)

---

## 제 1 정규형(1NF; First Normal Form)

    - 릴레이션의 모든 속성이 더는 분해되지 않는 원자 값(atomic value)만 가지면 제 1 정규형을 만족함

## 제 2 정규형(2NF; Second Normal Form)

    - 릴레이션이 제 1 정규형에 속하고, 기본키가 아닌 모든 속성이 기본키에 완전 함수 종속되면 제 2 정규형을 만족함

## 제 3 정규형(3NF; Third Normal Form)

    - 릴레이션이 제 2 정규형에 속하고, 기본키가 아닌 모든 속성이 기본키에 이행적 함수 종속이 되지 않으면 제 3 정규형을 만족함

## 보이스/코드 정규형(BCNF; Boyce/Codd Normal Form)

    - 릴레이션의 함수 종속 관계에서 모든 결정자가 후보키이면 보이스/코드 정규현에 속한다.

### 제 4 정규형

    - 릴레이션이 보이스/코드 정규형을 만족하면서, 함수 종속이 아닌 다치 종속(MVD; Multi Valued Dependency)을 제거하면 제 4 정규형에 속함

### 제 5 정규형

    - 릴레이션이 제 4 정규형을 만족하면서, 후보키를 통하지 않는 조인 종속 (JD; Join Dependency)을 제거하면 제 5 정규형에 속함

## 정규화 시 주의사항

- 모든 릴레이션이 제 5 정규형에 속해야만 바람직한 것은 아님
- 일반적으로 제 3 정규형이나 보이스/코드 정규형에 속하도록 릴레이션을 분해하여 데이터 중복을 줄이고 이상 현상을 해결하는 경우가 많음

---

## 반정규화(de-normalization)

- 정규화와는 반대로 보다 낮은 수준의 정규형으로 릴레이션을 통합
- 성능 저하가 문제될 경우 분해된 릴레이션을 역으로 통합, 성능을 향상시키는 설계 방법

- 높은 정규형을 만족하는 릴레이션 스키마가 반드시 최적이라고 할 수는 없음
